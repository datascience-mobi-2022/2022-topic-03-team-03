---
title: "Proteome wide screen for RNA-dependent Proteins in interphasic HeLa cells"
author: "Bolz, C., Bonsen, M., Pott, M., Simon, M."
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

RNA and proteins represent a symbiotic system. Proteins need RNA as a template for their biosynthesis as stated by Francis Crick in his “Central Dogma of Molecular Biology” (Crick, 1970). Vice versa, studies have shown that proteins need RNA for their catalytic activity, for instance in the RNA-induced silencing complex (Pratt and Macrae, 2009; Wilson and Doudna, 2013). Additionally, some RNA depends on proteins for its synthesis and stability (Kishore *et al.*, 2010). A family of proteins which illustrates this symbiotic relationship are RNA-binding proteins (RBPs). RBPs present a class of proteins whose interactome depends on RNA. They were shown to play a crucial role in RNA metabolism (Kishore *et al.*, 2010), cancer development (Wei *et al.*, 2022), and genetic disease (Gebauer *et al.*, 2021). Therefore, a deeper understanding of RNA binding and RNA-Protein interaction strengthens our ability to adjust and modulate the cellular mechanisms affected.

RBPs can be further categorized into “true” RBPs (e.g. DICER, NPM3), those RNA-binding proteins which directly bind to RNA, and “RBP interacting proteins” which merely interact with “true” RBPs (eg. RBBP7). Furthermore, “true" RBPs can be subcategorized into “RNA-dependent”, meaning relying on RNA for their whole and correct function (eg. DICER) and “partially RNA dependent”, those that only require RNA for certain functions or transport (eg. NPM3) (see Fig. 1) (Caudron-Herger *et al.*, 2019; Corley *et al.*, 2020).

<center>
```{r, echo = FALSE, fig.width=6, fig.height=4}
library(knitr)
include_graphics("C:\\Daten\\Uni\\4. Fachsemester\\Data Analysis\\Figure1.png")
```
</center>
**Figure 1**. Categorization of RNA-binding proteins: RBPs can be categorized into “true” RBPs, those RNA-binding proteins which directly bind to RNA, “RBP interacting proteins” which merely interact with “true” RBPs. “True” RBPs are subcategorized into “RNA-dependent”, meaning relying on RNA for their whole and correct function and “partially RNA dependent”, those that only require RNA for certain functions or transport. DICER = Endoribonuclease Dicer; NPM3 = Nucleoplasmin 3; RBBP7 = RNA-binding protein binding protein 7.

Several approaches to study RNA-Protein interaction and to identify new RBPs were established such as RaPID and CLIP-Seq. These methods either only analyze the interaction between the RNA of interest and additional proteins (RaPID) or a protein of interest and the different RNA it is interacting with (CLIP-Seq) (Qin *et al.*, 2021). Therefore, approaching  the study of RNA-Binding Protein interaction networks globally (Sternburg and Karginov, 2020) has become a matter of interest. A method published by Caudron-Herger *et al.* enables analysis and quantification of whole cell interactomes. Furthermore, it allows for identification of new RBPs through RNase treatment and density gradient ultracentrifugation. Subsequently, the resulting fraction shifts of proteins identified with mass spectrometry were analyzed bioinformatically (Caudron-Herger *et al.*, 2019, Caudron-Herger *et al.*, 2020).

In this project, we aimed to identify RBPs and possible RBP candidates using bioinformatics in R. Beyond that, we hoped to discover crucial determining variables in our data hinting to RBPs without following our entire analysis protocol. We cross-referenced our results with established databases such as R-DeeP (https://r-deep.dkfz.de/; Caudron Herger *et al.*, 2019), UniProt (https://www.uniprot.org/) and RBP2GO (https://rbp2go.dkfz.de/; Caudron-Herger *et al.*, 2021). Our dataset focusing on of interphase synchronized HeLa S3 cells was obtained by the aforementioned method published by Caudron-Herger *et al.*

\newpage
# Methods
## Generation of the dataset
Interphasic HeLa S3 cells were harvested and lyzed. The lyzate was split in two and one sample was treated with a RNase mixture (referred to as RNase (RNA)). The other sample was left untreated (referred to as control (ctrl)). Both samples were loaded onto a 5 % to 25 % sucrose density gradient, grouped in 25 fractions and separated using ultracentrifugation. For each condition, technical triplicates were generated. Each fraction was then analyzed using mass spectrometry. Proteins were identified using UniProt. The amount of protein per fraction, condition and replicate were stored in arbitrary units as a .csv-file (for full protocol see: Caudron-Herger *et al.*, 2019).

## Clean-Up and sorting of the dataset
Using the R package tidyverse two separate data frames were generated containing either all untreated (_ctrl) or RNase treated (_RNA) replicates. Both data frames as well as the raw data set were screened for rows containing  zeros only. Those rows were removed from the data frame and stored in a new data frame.

## Normalization
To rule out batch to batch effects and technical errors, the protein amount per replicate (Rep) and fraction (Frac) were normalized as well with regard to each condition.

Normalization visualized by plotting protein distribution in both conditions prior to normalization in comparison to protein distribution after normalization. 

### Fraction-wise normalization 
Normalization for each fraction was performed applying the following equation:

$$Protein(norm) = \frac{maxcolsums}{ColSumme} * Protein(before)$$

*Protein(norm)* describes the normalized amount of a single protein per fraction and replicate.*ColSumme* represents the total amount of protein per fraction and replicate. For each fraction, one maximum was chosen. *maxcolsums* is the selected maximum total protein amount per fraction and replicate. The parameter *Protein(before)* describes the arbitrary amount of a single protein per fraction and replicate prior to normalization.

### Scaling the protein distrubition per replicate and condition
For better comparison, the protein amount per fraction was converted to a relative percentage scale applying the following equation:

$$Protein(relative) = \frac{Protein(norm)}{RowSum}*100$$

*Protein(relative)* describes the relative protein amount per fraction in relation to the total amount of the protein per replicate. *Protein(norm)* represents the normalized amount of a single protein per fraction and replicate. The total amount of a single protein per replicate is given by *RowSum*.

### Create separate dataframes
Next, data frames for each individual fraction and condition were created, containing the triplicate values for each protein. 

They follow the naming convention:
1. Fraction1_Ctrl for the triplicate values of the first fraction of the control group
2. Fraction_8_RNAse for the triplicate values of the eighth fraction of the RNase treated sample

## Calculation of means and standard deviation
The mean and standard deviation of the triplicates for each protein in each fraction were calculated using the built-in functions *mean()-*($\overline x$) and *sd()-function*$(\sigma)$ of R. Outliers were detected using $\overline x \pm 3\sigma$ as a cut-off. All values below and above were replaced with NA and not considered in the following calculations.

## Shapiro-Wilk Test
To test the normal distribution of the triplicate values, the Shapiro-Wilk test was chosen due to its high power in small populations in comparison to other tests. The test was performed using the built-in R function *shapiro_test()*. 

## Determination of Maxima
For all proteins in the control group and treated with RNase the global and local maxima were determined. For this purpose, the protein content (y-value) was compared to two neighbors right and left of the analyzed fraction (x-position). As relevant local maxima only those maxima were selceted that contained more than $2\%$ of the protein.

## Detection of Protein Shifts
As previous published (see Caudron-Herger *et al.*, 2019) only maxima with values $\geqq 25\%$ of the global maxima were used for shift detection.

The following convention was made:

1. Left-shift:\tab    Value < 1

2. Right-shift:\tab   Value > 1

3. No-Shift:\tab      Value = 0

These criteria are based on the equation used in the defined function for shift detection. The function selects the global maxima of each protein and condition and subtracts the fraction absolutes. The resulting value is used for Shift-direction determination.

$$Shift\ Value = |absolute\_max\_ctrl| - |absolute\_max\_rnase|$$
The variables *absolute\_max\_ctrl* and *absolute\_max\_rnase* describe the selected fraction with the global maxima for control and RNAse treatment respectivley. *Shift Value* is the determined value used for Shift-direction classification.

## Statistical analysis
To identify significant shifts statistical analysis on the difference in the relative protein amount (y-value) for each protein in the global maxima fraction of RNAse treatment was performed. All proteins with Shift values $\geqq |1|$ were analyzed.

### F-Test
To test whether our sample variances are comparable and therefore suitable for significance analysis a two-sided F Test was performed on each protein and fraction using the built-in R function *var.test()*. Significance level (p-value) was set to 0.01. Test was deemed positive if $p-value > 0.01$.

If *var.test()* is performed on all zero samples NA/NaN is returned. Those values can be ignored in further analysis since they are not relevant for maxima analysis.

If the returned p-value is smaller than 0.01 it was checked whether they were crucial at the shifting points of the maxima. Hence with the list of maxima, those necessary p-values were checked again as described above.

### Students T-Test
The two-tailed unpaired t-test was used to identify proteins with significant change in maxima after treatment. P-Values were calculated for each protein per fraction using the built-in R function *t.test()*. Fractions with detected maxima were compared to the significance of 0.05. The test was deemed positive if $p-value < 0.05$ therefore the change in maxima could be regarded as significant.

Since t-test was performed on both conditions the returned results were either TRUE/TRUE, TRUE/FALSE, FALSE/TRUE or FALSE/FALSE for ctrl and RNAse maxima. If the value is TRUE the p-value is smaller than the significane level and if its is FALSE the p-value is greater than the significance level. Proteins with either TRUE/FALSE, FALSE/TRUE or FALSE/FALSE as result were excluded from further analysis.

## Identification of potential RBPs by analysis of x- and y-shift

## k-means clustering
Using the libraries *corrplot*, *cluster* and *factoextra* k-means clustering was conducted using k-means algorithm. 

-quotient function: RNAse-value/ctrl-value (high values if it's a shifter)
-calculated rowSums of each proteins quotient (25 each)
-cluster variables: q_mat_sums (rowsum) and maximum quotient value
-best within cluster square distance with 3 clusters (although silhouette method said 2)
- insert cluster diagramm (around (0,0) non shifters -> small rowsum and small maximum, on the top right -> shifters as they have big maximum and rowsum) and in cluster between those 2 maybe proteins that don't shift as clearly as cluster 3.

## Comparing clustering results
## Linear regression analysis

\newpage
# Results
The initial data set consisted of 7086 proteins. After clean-up 7081 proteins remained for further analysis. Normalization was visualized for several reported Sure-shifters and non-shifters (see Caudron-Herger *et al.*, 2019). The selected proteins are:

Sure-Shifters: Sin3A, HDAC1, HNRPU, RFC2

Non-Shifters: ASNS, MCM2, MCM3
<center>
```{r, echo = FALSE, fig.width=4, fig.height=2}
library(knitr)
include_graphics("C:\\Daten\\Uni\\4. Fachsemester\\Data Analysis\\Figure2.png")
```
</center>
**Figure 2:**

# Discussion



